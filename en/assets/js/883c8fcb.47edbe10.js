"use strict";(self.webpackChunktil=self.webpackChunktil||[]).push([[3304],{1407:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var s=n(8632),a=n(4848),l=n(8453);const i={title:"Terraform\uc73c\ub85c EKS \ubc30\ud3ec \uc2dc \ubc1c\uc0dd\ud558\ub294 \ub9ac\uc18c\uc2a4 \ucda9\ub3cc \ud574\uacb0 \uac00\uc774\ub4dc",authors:["hyeonlim"],tags:["TIL","Terraform"]},t=void 0,o={authorsImageUrls:[void 0]},c=[{value:"\ud83d\udea8 \ubb38\uc81c \uc0c1\ud669",id:"-\ubb38\uc81c-\uc0c1\ud669",level:2},{value:"\ud83d\udd0d \ubb38\uc81c \uc6d0\uc778 \ubd84\uc11d",id:"-\ubb38\uc81c-\uc6d0\uc778-\ubd84\uc11d",level:2},{value:"\uadfc\ubcf8 \uc6d0\uc778: \uac1c\ubc1c \ud658\uacbd \ud63c\ub3d9\uc73c\ub85c \uc778\ud55c \ub9ac\uc18c\uc2a4 \uc911\ubcf5",id:"\uadfc\ubcf8-\uc6d0\uc778-\uac1c\ubc1c-\ud658\uacbd-\ud63c\ub3d9\uc73c\ub85c-\uc778\ud55c-\ub9ac\uc18c\uc2a4-\uc911\ubcf5",level:3},{value:"\uc138\ubd80 \uc6d0\uc778\ub4e4",id:"\uc138\ubd80-\uc6d0\uc778\ub4e4",level:3},{value:"1. EIP \ud55c\ub3c4 \ucd08\uacfc \ubb38\uc81c",id:"1-eip-\ud55c\ub3c4-\ucd08\uacfc-\ubb38\uc81c",level:4},{value:"2. \ub9ac\uc18c\uc2a4 \uc911\ubcf5 \ubb38\uc81c",id:"2-\ub9ac\uc18c\uc2a4-\uc911\ubcf5-\ubb38\uc81c",level:4},{value:"3. Terraform \uc0c1\ud0dc \ud30c\uc77c \ubd84\ub9ac\ub85c \uc778\ud55c \ubb38\uc81c",id:"3-terraform-\uc0c1\ud0dc-\ud30c\uc77c-\ubd84\ub9ac\ub85c-\uc778\ud55c-\ubb38\uc81c",level:4},{value:"\ud83d\udee0\ufe0f \ud574\uacb0 \uacfc\uc815",id:"\ufe0f-\ud574\uacb0-\uacfc\uc815",level:2},{value:"1\ub2e8\uacc4: EIP \uc0ac\uc6a9\ub7c9 \ud655\uc778 \ubc0f \ubd84\uc11d",id:"1\ub2e8\uacc4-eip-\uc0ac\uc6a9\ub7c9-\ud655\uc778-\ubc0f-\ubd84\uc11d",level:3},{value:"2\ub2e8\uacc4: Terraform \uc0c1\ud0dc \ud655\uc778",id:"2\ub2e8\uacc4-terraform-\uc0c1\ud0dc-\ud655\uc778",level:3},{value:"3\ub2e8\uacc4: EIP \ubb38\uc81c \ud574\uacb0",id:"3\ub2e8\uacc4-eip-\ubb38\uc81c-\ud574\uacb0",level:3},{value:"4\ub2e8\uacc4: \uae30\uc874 \ub9ac\uc18c\uc2a4 Import",id:"4\ub2e8\uacc4-\uae30\uc874-\ub9ac\uc18c\uc2a4-import",level:3},{value:"5\ub2e8\uacc4: Terraform \uc801\uc6a9",id:"5\ub2e8\uacc4-terraform-\uc801\uc6a9",level:3},{value:"\ud83d\udd27 kubectl \uc5f0\uacb0 \ubb38\uc81c \ud574\uacb0",id:"-kubectl-\uc5f0\uacb0-\ubb38\uc81c-\ud574\uacb0",level:2},{value:"\ud83d\udcdd \uad50\ud6c8 \ubc0f \uc608\ubc29 \ubc29\ubc95",id:"-\uad50\ud6c8-\ubc0f-\uc608\ubc29-\ubc29\ubc95",level:2},{value:"1. \uac1c\ubc1c \ud658\uacbd \uad00\ub9ac \uc6d0\uce59",id:"1-\uac1c\ubc1c-\ud658\uacbd-\uad00\ub9ac-\uc6d0\uce59",level:3},{value:"2. \uc548\uc804\ud55c \ud658\uacbd \uc804\ud658 \uc808\ucc28",id:"2-\uc548\uc804\ud55c-\ud658\uacbd-\uc804\ud658-\uc808\ucc28",level:3},{value:"3. \ub9ac\uc18c\uc2a4 \uc815\ub9ac \uc2dc \uc8fc\uc758\uc810",id:"3-\ub9ac\uc18c\uc2a4-\uc815\ub9ac-\uc2dc-\uc8fc\uc758\uc810",level:3},{value:"4. EIP \uad00\ub9ac",id:"4-eip-\uad00\ub9ac",level:3},{value:"5. Terraform \uc0c1\ud0dc \uad00\ub9ac",id:"5-terraform-\uc0c1\ud0dc-\uad00\ub9ac",level:3},{value:"6. \uc548\uc804\ud55c \ubc30\ud3ec \uc804\ub7b5",id:"6-\uc548\uc804\ud55c-\ubc30\ud3ec-\uc804\ub7b5",level:3},{value:"\ud83c\udfaf \uacb0\ub860",id:"-\uacb0\ub860",level:2}];function d(e){const r={code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:["\n",(0,a.jsx)(r.h2,{id:"-\ubb38\uc81c-\uc0c1\ud669",children:"\ud83d\udea8 \ubb38\uc81c \uc0c1\ud669"}),"\n",(0,a.jsx)(r.p,{children:"Terraform\uc73c\ub85c EKS \ud074\ub7ec\uc2a4\ud130\ub97c \ubc30\ud3ec\ud558\ub358 \uc911 \ub2e4\uc74c\uacfc \uac19\uc740 \uc624\ub958\ub4e4\uc774 \uc5f0\uc18d\uc73c\ub85c \ubc1c\uc0dd\ud588\uc5b4\uc694:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"Error: creating EC2 EIP: operation error EC2: AllocateAddress,\nhttps response error StatusCode: 400, RequestID: <requiest id>,\napi error AddressLimitExceeded: The maximum number of addresses has been reached.\n\nError: creating KMS Alias (alias/eks/cwave): operation error KMS: CreateAlias,\nhttps response error StatusCode: 400, RequestID: <requiest id>,\nAlreadyExistsException: An alias with the name arn:aws:kms:ap-northeast-2:368677659737:alias/eks/cwave already exists\n\nError: creating EKS Cluster (cwave): operation error EKS: CreateCluster,\nhttps response error StatusCode: 409, RequestID: <requiest id>,\nResourceInUseException: Cluster already exists with name: cwave\n\nError: creating IAM Role (efs-csi): operation error IAM: CreateRole,\nhttps response error StatusCode: 409, RequestID: <requiest id>,\nEntityAlreadyExists: Role with name efs-csi already exists.\n"})}),"\n",(0,a.jsx)(r.h2,{id:"-\ubb38\uc81c-\uc6d0\uc778-\ubd84\uc11d",children:"\ud83d\udd0d \ubb38\uc81c \uc6d0\uc778 \ubd84\uc11d"}),"\n",(0,a.jsx)(r.h3,{id:"\uadfc\ubcf8-\uc6d0\uc778-\uac1c\ubc1c-\ud658\uacbd-\ud63c\ub3d9\uc73c\ub85c-\uc778\ud55c-\ub9ac\uc18c\uc2a4-\uc911\ubcf5",children:"\uadfc\ubcf8 \uc6d0\uc778: \uac1c\ubc1c \ud658\uacbd \ud63c\ub3d9\uc73c\ub85c \uc778\ud55c \ub9ac\uc18c\uc2a4 \uc911\ubcf5"}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\uc2e4\uc81c \ubc1c\uc0dd \uacfc\uc815:"})}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsxs)(r.li,{children:["\uac1c\ubc1c \ud658\uacbd\uc5d0 ",(0,a.jsx)(r.code,{children:"local"}),"\uacfc ",(0,a.jsx)(r.code,{children:"aws"})," \ub450 \uac1c\uc758 \ud3f4\ub354\uac00 \uc874\uc7ac"]}),"\n",(0,a.jsx)(r.li,{children:"\uc9c0\uae08\uae4c\uc9c0 local \ud658\uacbd\uacfc aws \ud658\uacbd\uc744 \ucc29\uac01\ud574\uc11c \uac1c\ubc1c\uc744 \uc9c4\ud589"}),"\n",(0,a.jsx)(r.li,{children:"local \ud658\uacbd\uc5d0\uc11c \uc0dd\uc131\ud55c Terraform \ub9ac\uc18c\uc2a4\ub97c \uc815\ud655\ud558\uac8c \uc0ad\uc81c\ud558\uc9c0 \uc54a\uc74c"}),"\n",(0,a.jsxs)(r.li,{children:["aws \ud3f4\ub354\ub85c \uc774\ub3d9\ud574\uc11c \ub2e4\uc2dc ",(0,a.jsx)(r.code,{children:"terraform apply"}),"\ub97c \uc2dc\ub3c4"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"\uacb0\uacfc"}),": \ub3d9\uc77c\ud55c \ub9ac\uc18c\uc2a4\uba85\uc73c\ub85c \uc778\ud55c \uc911\ubcf5 \uc0dd\uc131 \uc2dc\ub3c4\ub85c \ucda9\ub3cc \ubc1c\uc0dd\ud588\uc5b4\uc694"]}),"\n"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\ud3f4\ub354 \uad6c\uc870 \uc608\uc2dc:"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"project/\n\u251c\u2500\u2500 local/          # \ub85c\uceec \uac1c\ubc1c\uc6a9 (\uae30\uc874 \ub9ac\uc18c\uc2a4 \uc794\uc874)\n\u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2514\u2500\u2500 terraform.tfstate\n\u2514\u2500\u2500 aws/            # AWS \ud658\uacbd\uc6a9 (\uc0c8\ub85c \ubc30\ud3ec \uc2dc\ub3c4)\n    \u251c\u2500\u2500 main.tf\n    \u2514\u2500\u2500 terraform.tfstate\n"})}),"\n",(0,a.jsx)(r.h3,{id:"\uc138\ubd80-\uc6d0\uc778\ub4e4",children:"\uc138\ubd80 \uc6d0\uc778\ub4e4"}),"\n",(0,a.jsx)(r.h4,{id:"1-eip-\ud55c\ub3c4-\ucd08\uacfc-\ubb38\uc81c",children:"1. EIP \ud55c\ub3c4 \ucd08\uacfc \ubb38\uc81c"}),"\n",(0,a.jsx)(r.p,{children:"AWS \uacc4\uc815\ub2f9 EIP(Elastic IP) \ud560\ub2f9 \ud55c\ub3c4\uac00 \uc788\uace0 \uc81c\uac00 \ud655\uc778\ud588\uc744 \ub54c\ub294 5\uac1c\uac00 \ud560\ub2f9 \ud55c\ub3c4\uac00 \uc788\uc5c8\uc5b4\uc694."}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"# \ud604\uc7ac EIP \uc0ac\uc6a9\ub7c9 \ud655\uc778\naws ec2 describe-addresses --region ap-northeast-2\n"})}),"\n",(0,a.jsx)(r.h4,{id:"2-\ub9ac\uc18c\uc2a4-\uc911\ubcf5-\ubb38\uc81c",children:"2. \ub9ac\uc18c\uc2a4 \uc911\ubcf5 \ubb38\uc81c"}),"\n",(0,a.jsx)(r.p,{children:"EKS \ud074\ub7ec\uc2a4\ud130\ub97c \uc0ad\uc81c\ud588\uc9c0\ub9cc \uad00\ub828 \ub9ac\uc18c\uc2a4\ub4e4(IAM \uc5ed\ud560, KMS \ubcc4\uce6d \ub4f1)\uc740 \uc790\ub3d9\uc73c\ub85c \uc0ad\uc81c\ub418\uc9c0 \uc54a\uc558\uc5b4\uc694."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\uc65c \uc774\ub7f0 \uc77c\uc774 \ubc1c\uc0dd\ud558\ub294\uac00?"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["EKS \ud074\ub7ec\uc2a4\ud130 \uc0ad\uc81c \uc2dc ",(0,a.jsx)(r.strong,{children:"IAM \uc5ed\ud560\uc740 \uc790\ub3d9\uc73c\ub85c \uc0ad\uc81c\ub418\uc9c0 \uc54a\uc544\uc694."})]}),"\n",(0,a.jsx)(r.li,{children:"KMS \ubcc4\uce6d\ub3c4 \ub9c8\ucc2c\uac00\uc9c0\ub85c \uc218\ub3d9 \uc0ad\uc81c\uac00 \ud544\uc694\ud574\uc694."}),"\n"]}),"\n",(0,a.jsx)(r.h4,{id:"3-terraform-\uc0c1\ud0dc-\ud30c\uc77c-\ubd84\ub9ac\ub85c-\uc778\ud55c-\ubb38\uc81c",children:"3. Terraform \uc0c1\ud0dc \ud30c\uc77c \ubd84\ub9ac\ub85c \uc778\ud55c \ubb38\uc81c"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"local/terraform.tfstate"}),"\uc640 ",(0,a.jsx)(r.code,{children:"aws/terraform.tfstate"}),"\uac00 \uac01\uac01 \uad00\ub9ac\ub3fc\uc694."]}),"\n",(0,a.jsx)(r.li,{children:"\uc2e4\uc81c AWS \ub9ac\uc18c\uc2a4\ub294 \ub3d9\uc77c\ud558\uc9c0\ub9cc Terraform \uc0c1\ud0dc\ub294 \ubd84\ub9ac\ub418\uc5b4 \uc788\uc5b4\uc694."}),"\n",(0,a.jsx)(r.li,{children:"\uc0c8\ub85c\uc6b4 \ud3f4\ub354\uc5d0\uc11c \ubc30\ud3ec \uc2dc \uae30\uc874 \ub9ac\uc18c\uc2a4\ub97c \uc778\uc2dd\ud558\uc9c0 \ubabb\ud558\ub294 \ubb38\uc81c\uac00 \uc788\ub294 \uac83\uc744 \ud30c\uc545\ud588\uc5b4\uc694."}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"\ufe0f-\ud574\uacb0-\uacfc\uc815",children:"\ud83d\udee0\ufe0f \ud574\uacb0 \uacfc\uc815"}),"\n",(0,a.jsx)(r.h3,{id:"1\ub2e8\uacc4-eip-\uc0ac\uc6a9\ub7c9-\ud655\uc778-\ubc0f-\ubd84\uc11d",children:"1\ub2e8\uacc4: EIP \uc0ac\uc6a9\ub7c9 \ud655\uc778 \ubc0f \ubd84\uc11d"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"# EIP \ubaa9\ub85d\uacfc \uc5f0\uacb0 \uc0c1\ud0dc \ud655\uc778\naws ec2 describe-addresses --region ap-northeast-2 --output table\n\n# \uac01 EIP\uac00 \ubb34\uc5c7\uc5d0 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub294\uc9c0 \ud655\uc778\naws ec2 describe-network-interfaces --region ap-northeast-2 \\\n  --network-interface-ids eni-xxxx eni-yyyy \\\n  --query 'NetworkInterfaces[*].{NetworkInterfaceId:NetworkInterfaceId,Description:Description,Status:Status}'\n"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\uacb0\uacfc \ubd84\uc11d:"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-json",children:'[\n  {\n    "NetworkInterfaceId": "eni-id",\n    "Description": "Interface for NAT Gateway nat-id",\n    "Status": "in-use"\n  }\n  // ... 5\uac1c\uc758 EIP\uac00 \ubaa8\ub450 NAT Gateway\uc5d0 \uc5f0\uacb0\ub428\n]\n'})}),"\n",(0,a.jsx)(r.h3,{id:"2\ub2e8\uacc4-terraform-\uc0c1\ud0dc-\ud655\uc778",children:"2\ub2e8\uacc4: Terraform \uc0c1\ud0dc \ud655\uc778"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"# \ud604\uc7ac Terraform\uc5d0\uc11c \uad00\ub9ac\ud558\ub294 EIP \ud655\uc778\nterraform plan | grep eip\n"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\uacb0\uacfc:"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:'aws_eip.nat["c"]: Refreshing state... [id=eipalloc-id]\naws_eip.nat["a"]: Refreshing state... [id=eipalloc-id]\n# aws_eip.nat["b"] will be created <- \uc774 \ubd80\ubd84\uc774 \ubb38\uc81c!\n'})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\ubc1c\uacac\ud55c \ubb38\uc81c\uc810:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:'nat["a"]'}),"\uc640 ",(0,a.jsx)(r.code,{children:'nat["c"]'}),"\ub294 \uc774\ubbf8 Terraform \uc0c1\ud0dc\uc5d0 \uc874\uc7ac\ud574\uc694."]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:'nat["b"]'}),"\ub9cc \uc0c8\ub85c \uc0dd\uc131\ud558\ub824\uace0 \ud574\uc11c EIP \ud55c\ub3c4 \ucd08\uacfc \ubc1c\uc0dd\uac00 \ubc1c\uc0dd\ud588\uc5b4\uc694."]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"3\ub2e8\uacc4-eip-\ubb38\uc81c-\ud574\uacb0",children:"3\ub2e8\uacc4: EIP \ubb38\uc81c \ud574\uacb0"}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\ubc29\ubc95 1: \uae30\uc874 EIP \uc7ac\uc0ac\uc6a9"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"# \uc0ac\uc6a9 \uac00\ub2a5\ud55c EIP \ud655\uc778 (a, c\uac00 \uc544\ub2cc \uac83\ub4e4)\n# eipalloc-id\n# eipalloc-id\n# eipalloc-id\n\n# \ud2b9\uc815 EIP\uac00 \uc5b4\ub5a4 NAT Gateway\uc5d0 \uc5f0\uacb0\ub418\uc5b4 \uc788\ub294\uc9c0 \ud655\uc778\naws ec2 describe-nat-gateways --region ap-northeast-2 \\\n  --query 'NatGateways[?NatGatewayAddresses[0].AllocationId==`eipalloc-id`].{NatGatewayId:NatGatewayId,State:State}'\n"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\uacb0\uacfc:"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-json",children:'[\n  {\n    "NatGatewayId": "nat-id",\n    "State": "deleted" // \uc774\ubbf8 \uc0ad\uc81c\ub428\n  },\n  {\n    "NatGatewayId": "nat-id",\n    "State": "available" // \uc0ac\uc6a9 \uc911\n  }\n]\n'})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\ud574\uacb0 \ub2e8\uacc4:"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"# 1. \uc0ac\uc6a9 \uc911\uc778 NAT Gateway \uc0ad\uc81c\naws ec2 delete-nat-gateway --nat-gateway-id nat-id --region ap-northeast-2\n\n# 2. \uc0ad\uc81c \uc644\ub8cc \ub300\uae30\naws ec2 describe-nat-gateways --region ap-northeast-2 --nat-gateway-ids nat-id --query 'NatGateways[0].State'\n\n# 3. \ud574\uc81c\ub41c EIP\ub97c Terraform\uc73c\ub85c \uac00\uc838\uc624\uae30\nterraform import 'aws_eip.nat[\"b\"]' eipalloc-id\n"})}),"\n",(0,a.jsx)(r.h3,{id:"4\ub2e8\uacc4-\uae30\uc874-\ub9ac\uc18c\uc2a4-import",children:"4\ub2e8\uacc4: \uae30\uc874 \ub9ac\uc18c\uc2a4 Import"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"# EKS \ud074\ub7ec\uc2a4\ud130 \uac00\uc838\uc624\uae30\nterraform import module.eks.aws_eks_cluster.this[0] cwave\n\n# KMS \ubcc4\uce6d \uac00\uc838\uc624\uae30 (\ub530\uc634\ud45c \uc8fc\uc758!)\nterraform import 'module.eks.module.kms.aws_kms_alias.this[\"cluster\"]' alias/eks/cwave\n\n# IAM \uc5ed\ud560\ub4e4 \uac00\uc838\uc624\uae30\nterraform import module.attach_efs_csi_role.aws_iam_role.this[0] efs-csi\nterraform import module.ebs_csi_irsa.aws_iam_role.this[0] cwave-ebs-csi-controller\nterraform import module.lb_controller_role.aws_iam_role.this[0] eks-aws-lb-controller-role\n"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Import \uc2dc \uc8fc\uc758\uc0ac\ud56d:"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"\uc778\ub371\uc2a4\uac00 \uc788\ub294 \ub9ac\uc18c\uc2a4\ub294 \ub530\uc634\ud45c\ub85c \uac10\uc2f8\uc8fc\ub294 \uac83\uc774 \uc911\uc694\ud574\uc694."}),"\n",(0,a.jsx)(r.li,{children:"\uc815\ud655\ud55c \ub9ac\uc18c\uc2a4 \uc774\ub984\uacfc ID \ud655\uc778 \ud544\uc218\uc785\ub2c8\ub2e4."}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"5\ub2e8\uacc4-terraform-\uc801\uc6a9",children:"5\ub2e8\uacc4: Terraform \uc801\uc6a9"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"# \uacc4\ud68d \ud655\uc778\nterraform plan\n\n# \ubb38\uc81c\uc5c6\uc73c\uba74 \uc801\uc6a9\nterraform apply\n"})}),"\n",(0,a.jsx)(r.h2,{id:"-kubectl-\uc5f0\uacb0-\ubb38\uc81c-\ud574\uacb0",children:"\ud83d\udd27 kubectl \uc5f0\uacb0 \ubb38\uc81c \ud574\uacb0"}),"\n",(0,a.jsx)(r.p,{children:"\ubc30\ud3ec \uc644\ub8cc \ud6c4 kubectl \uba85\ub839\uc5b4 \uc2e4\ud589 \uc2dc DNS \uc624\ub958 \ubc1c\uc0dd:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"kubectl get po\n# Error: dial tcp: lookup .gr7.ap-northeast-2.eks.amazonaws.com on 127.0.0.11:53: no such host\n"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\ud574\uacb0 \ubc29\ubc95:"})}),"\n",(0,a.jsx)(r.p,{children:"\uc5c5\ub370\uc774\ud130\ub97c \uc0c8\ub85c \ud574\uc90c\uc73c\ub85c\uc368 \uae30\uc874 context\ub97c switch\ub97c \uc9c4\ud589\ud574\uc8fc\uba74 \uc815\uc0c1\uc801\uc73c\ub85c \ub3d9\uc791\ud558\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc5b4\uc694."}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"# kubeconfig \uc5c5\ub370\uc774\ud2b8\naws eks update-kubeconfig --region ap-northeast-2 --name cwave\n\n# \uc5f0\uacb0 \ud14c\uc2a4\ud2b8\nkubectl get nodes\nkubectl get pods -A\n"})}),"\n",(0,a.jsx)(r.h2,{id:"-\uad50\ud6c8-\ubc0f-\uc608\ubc29-\ubc29\ubc95",children:"\ud83d\udcdd \uad50\ud6c8 \ubc0f \uc608\ubc29 \ubc29\ubc95"}),"\n",(0,a.jsx)(r.h3,{id:"1-\uac1c\ubc1c-\ud658\uacbd-\uad00\ub9ac-\uc6d0\uce59",children:"1. \uac1c\ubc1c \ud658\uacbd \uad00\ub9ac \uc6d0\uce59"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.strong,{children:"\ud658\uacbd\ubcc4 \ud3f4\ub354 \ubd84\ub9ac \uc2dc \uba85\ud655\ud55c \ub124\uc774\ubc0d \uc0ac\uc6a9"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.strong,{children:"\ud604\uc7ac \uc791\uc5c5 \uc911\uc778 \ud658\uacbd\uc744 \ud56d\uc0c1 \ud655\uc778"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.strong,{children:"\ud658\uacbd \uc804\ud658 \uc2dc \uae30\uc874 \ub9ac\uc18c\uc2a4 \uc815\ub9ac \ud6c4 \uc9c4\ud589"})}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"# \ud658\uacbd \ud655\uc778 \uc2b5\uad00\ud654\npwd                    # \ud604\uc7ac \uc791\uc5c5 \ub514\ub809\ud130\ub9ac \ud655\uc778\nterraform workspace show  # Terraform \uc6cc\ud06c\uc2a4\ud398\uc774\uc2a4 \ud655\uc778\naws sts get-caller-identity  # \ud604\uc7ac AWS \uacc4\uc815/\uc5ed\ud560 \ud655\uc778\n"})}),"\n",(0,a.jsx)(r.h3,{id:"2-\uc548\uc804\ud55c-\ud658\uacbd-\uc804\ud658-\uc808\ucc28",children:"2. \uc548\uc804\ud55c \ud658\uacbd \uc804\ud658 \uc808\ucc28"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"# \uae30\uc874 \ud658\uacbd \uc815\ub9ac\nterraform destroy -auto-approve\n\n# \uc0c1\ud0dc \ud30c\uc77c \ubc31\uc5c5\ncp terraform.tfstate terraform.tfstate.backup\n\n# \uc0c8 \ud658\uacbd\uc73c\ub85c \uc774\ub3d9\ncd ../aws\n\n# \ub9ac\uc18c\uc2a4 \ud655\uc778 \ud6c4 \ubc30\ud3ec\nterraform plan\nterraform apply\n"})}),"\n",(0,a.jsx)(r.h3,{id:"3-\ub9ac\uc18c\uc2a4-\uc815\ub9ac-\uc2dc-\uc8fc\uc758\uc810",children:"3. \ub9ac\uc18c\uc2a4 \uc815\ub9ac \uc2dc \uc8fc\uc758\uc810"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"EKS \ud074\ub7ec\uc2a4\ud130 \uc0ad\uc81c \uc2dc IAM \uc5ed\ud560, KMS \ubcc4\uce6d \ub4f1\uc740 \uc218\ub3d9\uc73c\ub85c \uc0ad\uc81c\ud574\uc8fc\uc5b4\uc57c \ud574\uc694."}),"\n",(0,a.jsx)(r.li,{children:"\ub9cc\uc57d \uc0ad\uc81c\ud574\uc8fc\uc5b4\uc57c \ud558\ub294\uac8c \ub9ce\ub2e4\uba74 Terraform import\ub97c \ud65c\uc6a9\ud558\uc5ec \uae30\uc874 \ub9ac\uc18c\uc2a4 \uc7ac\uc0ac\uc6a9\ud560 \uc218 \uc788\uc5b4\uc694."}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"4-eip-\uad00\ub9ac",children:"4. EIP \uad00\ub9ac"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"AWS \uacc4\uc815\uc758 EIP \ud55c\ub3c4\ub97c \ubbf8\ub9ac \ud655\uc778\ud558\ub294 \uac83\uc774 \uc911\uc694\ud574\uc694."}),"\n",(0,a.jsx)(r.li,{children:"\ubd88\ud544\uc694\ud55c EIP\ub294 \uc815\uae30\uc801\uc73c\ub85c \uc815\ub9ac\ud558\uace0 \ud544\uc694\uc2dc AWS Support\ub97c \ud1b5\ud574 \ud55c\ub3c4 \uc99d\uac00 \uc694\uccad\ud574\uc8fc\uc5b4\uc57c \ud569\ub2c8\ub2e4."}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"5-terraform-\uc0c1\ud0dc-\uad00\ub9ac",children:"5. Terraform \uc0c1\ud0dc \uad00\ub9ac"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"terraform plan"}),"\uc73c\ub85c \uc0dd\uc131\ub420 \ub9ac\uc18c\uc2a4\ub97c \ubbf8\ub9ac \ud655\uc778\ud558\ub294 \uc2b5\uad00\uc774 \uc815\ub9d0 \uc911\uc694\ud569\ub2c8\ub2e4."]}),"\n",(0,a.jsx)(r.li,{children:"\uae30\uc874 \ub9ac\uc18c\uc2a4\uc640\uc758 \ucda9\ub3cc \uac00\ub2a5\uc131 \uac80\ud1a0 \ubc0f Import\ub97c \ud65c\uc6a9\ud55c \uae30\uc874 \ub9ac\uc18c\uc2a4 \uc7ac\uc0ac\uc6a9\uc744 \uace0\ub824\ud560 \uc218 \uc788\uc5b4\uc694."}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"6-\uc548\uc804\ud55c-\ubc30\ud3ec-\uc804\ub7b5",children:"6. \uc548\uc804\ud55c \ubc30\ud3ec \uc804\ub7b5"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"# \ubc30\ud3ec \uc804 \uccb4\ud06c\ub9ac\uc2a4\ud2b8\nterraform plan                    # \uc0dd\uc131\ub420 \ub9ac\uc18c\uc2a4 \ud655\uc778\naws ec2 describe-addresses        # EIP \uc0ac\uc6a9\ub7c9 \ud655\uc778\naws iam list-roles               # \uae30\uc874 IAM \uc5ed\ud560 \ud655\uc778\naws kms list-aliases             # \uae30\uc874 KMS \ubcc4\uce6d \ud655\uc778\n"})}),"\n",(0,a.jsx)(r.h2,{id:"-\uacb0\ub860",children:"\ud83c\udfaf \uacb0\ub860"}),"\n",(0,a.jsxs)(r.p,{children:["\uc774\ubc88 \ubb38\uc81c\uc758 \uadfc\ubcf8 \uc6d0\uc778\uc740 ",(0,a.jsx)(r.strong,{children:"\uac1c\ubc1c \ud658\uacbd \ud63c\ub3d9\uc73c\ub85c \uc778\ud55c \ub9ac\uc18c\uc2a4 \uc911\ubcf5"}),"\uc774\uc5c8\uc2b5\ub2c8\ub2e4. local\uacfc aws \ud658\uacbd\uc744 \uba85\ud655\ud788 \uad6c\ubd84\ud558\uc9c0 \uc54a\uace0 \uac1c\ubc1c\ud558\ub2e4\uac00, \uae30\uc874 \ub9ac\uc18c\uc2a4\ub97c \uc815\ub9ac\ud558\uc9c0 \uc54a\uc740 \uc0c1\ud0dc\uc5d0\uc11c \uc0c8\ub85c\uc6b4 \ud658\uacbd\uc5d0 \ubc30\ud3ec\ub97c \uc2dc\ub3c4\ud55c \uac83\uc774 \ubb38\uc81c\uc758 \uc2dc\uc791\uc774\uc5c8\uc2b5\ub2c8\ub2e4."]}),"\n",(0,a.jsx)(r.p,{children:"Terraform\uc73c\ub85c AWS \ub9ac\uc18c\uc2a4\ub97c \uad00\ub9ac\ud560 \ub54c\ub294 \ub2e4\uc74c \uc0ac\ud56d\ub4e4\uc744 \ubc18\ub4dc\uc2dc \uace0\ub824\ud574\uc57c \ud569\ub2c8\ub2e4:"}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.strong,{children:"\ud658\uacbd \ubd84\ub9ac\uc640 \uba85\ud655\ud55c \uc2dd\ubcc4"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.strong,{children:"\uae30\uc874 \ub9ac\uc18c\uc2a4\uc640\uc758 \ucda9\ub3cc \uac00\ub2a5\uc131"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.strong,{children:"Terraform Import\ub97c \ud65c\uc6a9\ud55c \uae30\uc874 \ub9ac\uc18c\uc2a4 \uc7ac\uc0ac\uc6a9"})}),"\n"]}),"\n",(0,a.jsxs)(r.p,{children:["\ud2b9\ud788 EKS\uc640 \uac19\uc740 \ubcf5\uc7a1\ud55c \uc11c\ube44\uc2a4\ub294 \uc5ec\ub7ec AWS \uc11c\ube44\uc2a4\uc640 \uc5f0\ub3d9\ub418\uc5b4 \uc788\uc5b4, \uc0ad\uc81c \uc2dc\uc5d0\ub3c4 \uc77c\ubd80 \ub9ac\uc18c\uc2a4\uac00 \ub0a8\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774\ub7f0 \uc0c1\ud669\uc5d0\uc11c\ub294 ",(0,a.jsx)(r.strong,{children:"Terraform Import"}),"\ub97c \ud65c\uc6a9\ud558\uc5ec \uae30\uc874 \ub9ac\uc18c\uc2a4\ub97c \uc7ac\uc0ac\uc6a9\ud558\ub294 \uac83\uc774 \uac00\uc7a5 \uc548\uc804\ud558\uace0 \ud6a8\uc728\uc801\uc778 \ud574\uacb0\ucc45\uc785\ub2c8\ub2e4."]}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\uad00\ub828 \uba85\ub839\uc5b4 \ubaa8\uc74c:"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"# \ud658\uacbd \ud655\uc778\npwd\nterraform workspace show\naws sts get-caller-identity\n\n# EIP \uad00\ub828\naws ec2 describe-addresses --region ap-northeast-2\naws ec2 release-address --allocation-id eipalloc-xxx --region ap-northeast-2\n\n# Terraform Import\nterraform import 'resource_address' resource_id\nterraform state list\nterraform plan\n\n# EKS \uad00\ub828\naws eks update-kubeconfig --region ap-northeast-2 --name cluster-name\nkubectl config current-context\n"})})]})}function h(e={}){const{wrapper:r}={...(0,l.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>t});var s=n(6540);const a={},l=s.createContext(a);function i(e){const r=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(l.Provider,{value:r},e.children)}},8632:e=>{e.exports=JSON.parse('{"permalink":"/en/blog/2025/07/19/terraform/terraform-errorHandling-title","editUrl":"https://github.com/indianaPoly/indianapoly.github.io/blog/terraform/2025-07-19-terraform-errorHandling-title.mdx","source":"@site/blog/terraform/2025-07-19-terraform-errorHandling-title.mdx","title":"Terraform\uc73c\ub85c EKS \ubc30\ud3ec \uc2dc \ubc1c\uc0dd\ud558\ub294 \ub9ac\uc18c\uc2a4 \ucda9\ub3cc \ud574\uacb0 \uac00\uc774\ub4dc","description":"{/ truncate /}","date":"2025-07-19T00:00:00.000Z","tags":[{"inline":true,"label":"TIL","permalink":"/en/blog/tags/til"},{"inline":true,"label":"Terraform","permalink":"/en/blog/tags/terraform"}],"readingTime":5.55,"hasTruncateMarker":true,"authors":[{"name":"\uace0\ud604\ub9bc","title":"\ud504\ub860\ud2b8\uc5d4\ub4dc | \ube14\ub85d\uccb4\uc778 Developer","url":"https://www.linkedin.com/in/%ED%98%84%EB%A6%BC-%EA%B3%A0-b53602221/","socials":{"github":"https://github.com/indianaPoly"},"imageURL":"https://ifh.cc/g/GagTYM.jpg","key":"hyeonlim","page":null}],"frontMatter":{"title":"Terraform\uc73c\ub85c EKS \ubc30\ud3ec \uc2dc \ubc1c\uc0dd\ud558\ub294 \ub9ac\uc18c\uc2a4 \ucda9\ub3cc \ud574\uacb0 \uac00\uc774\ub4dc","authors":["hyeonlim"],"tags":["TIL","Terraform"]},"unlisted":false,"prevItem":{"title":"Grafana + Prometheus + MySQL Exporter\ub97c \ud65c\uc6a9\ud55c MySQL \ubaa8\ub2c8\ud130\ub9c1 \uc124\uc815\uae30","permalink":"/en/blog/2025/07/20/docker/MYSQL-monioring-setting-title"},"nextItem":{"title":"Kubernetes Basic(3)","permalink":"/en/blog/2025/07/17/kubernetes/kubernetes-basic-3-title"}}')}}]);